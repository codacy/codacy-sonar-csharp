Validation of X.509 certificates is essential to create secure SSL/TLS sessions not vulnerable to man-in-the-middle attacks.
 
The certificate chain validation includes these steps:
 
- The certificate is issued by its parent Certificate Authority or the root CA trusted by the system.
- Each CA is allowed to issue certificates.
- Each certificate in the chain is not expired.

Itâ€™s not recommended to reinvent the wheel by implementing custom certificate chain validation.
 
TLS libraries provide built-in certificate validation functions that should be used.
 
## Noncompliant Code Example

    ServicePointManager.ServerCertificateValidationCallback +=
        (sender, certificate, chain, errors) => {
            return true; // Noncompliant: trust all certificates
        };

## Compliant Solution

    ServicePointManager.ServerCertificateValidationCallback +=
        (sender, certificate, chain, errors) =>
        {
            if (development) return true; // for development, trust all certificates
            return errors == SslPolicyErrors.None
                && validCerts.Contains(certificate.GetCertHashString()); // Compliant: trust only some certificates
        };

## See

- [OWASP Top 10 2021 Category A2](https://owasp.org/Top10/A02_2021-Cryptographic_Failures/) - Cryptographic Failures
- [OWASP Top 10 2021 Category A5](https://owasp.org/Top10/A05_2021-Security_Misconfiguration/) - Security Misconfiguration
- [OWASP Top 10 2021 Category A7](https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/) - Identification and
  Authentication Failures
- [OWASP Top 10 2017 Category A3](https://www.owasp.org/index.php/Top_10-2017_A3-Sensitive_Data_Exposure) - Sensitive Data Exposure
- [OWASP Top 10 2017 Category A6](https://www.owasp.org/index.php/Top_10-2017_A6-Security_Misconfiguration) - Security
  Misconfiguration
- [Mobile AppSec Verification
  Standard](https://mobile-security.gitbook.io/masvs/security-requirements/0x10-v5-network_communication_requirements) - Network Communication Requirements
- [OWASP Mobile Top 10 2016 Category M3](https://owasp.org/www-project-mobile-top-10/2016-risks/m3-insecure-communication) - Insecure
  Communication
- [MITRE, CWE-295](https://cwe.mitre.org/data/definitions/295) - Improper Certificate Validation