When a cookie is protected with the `secure` attribute set to *true* it will not be send by the browser over an unencrypted HTTP request and thus cannot be observed by an unauthorized person during a man-in-the-middle attack.
 
## Ask Yourself Whether
 
- the cookie is for instance a *session-cookie* not designed to be sent over non-HTTPS communication.
- it’s not sure that the website contains [mixed content](https://developer.mozilla.org/en-US/docs/Web/Security/Mixed_content) or not
  (ie HTTPS everywhere or not)

There is a risk if you answered yes to any of those questions.
 
## Recommended Secure Coding Practices

- It is recommended to use `HTTPs` everywhere so setting the `secure` flag to *true* should be the default behaviour
  when creating cookies.
- Set the `secure` flag to *true* for session-cookies.

## Sensitive Code Example
 
When the `HttpCookie.Secure` property is set to `false` then the cookie will be send during an unencrypted HTTP request:

    HttpCookie myCookie = new HttpCookie("Sensitive cookie");
    myCookie.Secure = false; //  Sensitive: a security-sensitive cookie is created with the secure flag set to false

The [default value](https://docs.microsoft.com/en-us/dotnet/api/system.web.httpcookie.secure?view=netframework-4.8) of `Secure` flag is `false`, unless overwritten by an application’s configuration file:

    HttpCookie myCookie = new HttpCookie("Sensitive cookie");
    //  Sensitive: a security-sensitive cookie is created with the secure flag not defined (by default set to false)

## Compliant Solution
 
Set the `HttpCookie.Secure` property to `true`:

    HttpCookie myCookie = new HttpCookie("Sensitive cookie");
    myCookie.Secure = true; // Compliant

Or change the default flag values for the whole application by editing the [Web.config configuration file](https://docs.microsoft.com/en-us/previous-versions/dotnet/netframework-4.0/ms228262%28v=vs.100%29):

    <httpCookies httpOnlyCookies="true" requireSSL="true" />

- the `requireSSL` attribute corresponds programmatically to the `Secure` field.
- the `httpOnlyCookies` attribute corresponds programmatically to the `httpOnly` field.

## See

- [OWASP Top 10 2021 Category A4](https://owasp.org/Top10/A04_2021-Insecure_Design/) - Insecure Design
- [OWASP Top 10 2021 Category A5](https://owasp.org/Top10/A05_2021-Security_Misconfiguration/) - Security Misconfiguration
- [OWASP Top 10 2017 Category A3](https://www.owasp.org/index.php/Top_10-2017_A3-Sensitive_Data_Exposure) - Sensitive Data Exposure
- [MITRE, CWE-311](https://cwe.mitre.org/data/definitions/311) - Missing Encryption of Sensitive Data
- [MITRE, CWE-315](https://cwe.mitre.org/data/definitions/315) - Cleartext Storage of Sensitive Information in a Cookie
- [MITRE, CWE-614](https://cwe.mitre.org/data/definitions/614) - Sensitive Cookie in HTTPS Session Without 'Secure' Attribute
- [SANS Top 25](https://www.sans.org/top25-software-errors/#cat3) - Porous Defenses